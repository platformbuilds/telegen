# Telegen v2.0 Environment File
# Task: DEP-012
# Location: /etc/telegen/telegen.env
# Fully loaded environment variables for the Telegen agent
# These override values in /etc/telegen/config.yaml

# =============================================================================
# OTLP Endpoint Configuration
# =============================================================================
# Primary OTLP endpoint for all signals
TELEGEN_OTLP_ENDPOINT=otel-collector:4317

# Protocol: grpc or http
TELEGEN_OTLP_PROTOCOL=grpc

# Send mode: parallel, failover, or round_robin
TELEGEN_OTLP_SEND_MODE=failover

# OTLP timeout
TELEGEN_OTLP_TIMEOUT=10s

# Enable gzip compression
TELEGEN_OTLP_GZIP=true

# Insecure mode (no TLS)
TELEGEN_OTLP_INSECURE=true

# Authentication (optional)
# TELEGEN_OTLP_HEADERS=Authorization=Bearer your-token-here

# TLS Configuration (when TELEGEN_OTLP_INSECURE=false)
# TELEGEN_OTLP_TLS_CA_FILE=/etc/telegen/certs/ca.crt
# TELEGEN_OTLP_TLS_CERT_FILE=/etc/telegen/certs/client.crt
# TELEGEN_OTLP_TLS_KEY_FILE=/etc/telegen/certs/client.key

# =============================================================================
# Core Agent Configuration
# =============================================================================
# Deployment mode: agent or collector
TELEGEN_MODE=agent

# Service name (auto-detected if not set)
# TELEGEN_SERVICE_NAME=my-service

# Instance ID (defaults to hostname)
# TELEGEN_INSTANCE_ID=my-instance

# =============================================================================
# Logging Configuration
# =============================================================================
# Log level: DEBUG, INFO, WARN, ERROR
TELEGEN_LOG_LEVEL=INFO

# Log format: json or text
TELEGEN_LOG_FORMAT=json

# =============================================================================
# Self-Telemetry Configuration
# =============================================================================
# Metrics port
TELEGEN_METRICS_PORT=19090

# Health check port
TELEGEN_HEALTH_PORT=8080

# Prometheus namespace
TELEGEN_PROMETHEUS_NAMESPACE=telegen

# Enable pprof for debugging
TELEGEN_PPROF_ENABLED=false

# =============================================================================
# eBPF Configuration
# =============================================================================
# Enable eBPF tracing
TELEGEN_EBPF_ENABLED=true

# Ring buffer size in bytes (default 256KB)
TELEGEN_EBPF_RINGBUF_SIZE=262144

# Perf buffer size in bytes
TELEGEN_EBPF_PERF_BUFFER_SIZE=8192

# BPF filesystem mount point
TELEGEN_EBPF_BPF_FS=/sys/fs/bpf

# TC backend: auto, netkit, tc
TELEGEN_EBPF_TC_BACKEND=auto

# Context propagation: disabled, all, or specific
TELEGEN_EBPF_CONTEXT_PROPAGATION=disabled

# Batch settings
TELEGEN_EBPF_BATCH_LENGTH=100
TELEGEN_EBPF_BATCH_TIMEOUT=1s

# Cache sizes
TELEGEN_EBPF_MYSQL_CACHE_SIZE=1024
TELEGEN_EBPF_POSTGRES_CACHE_SIZE=1024
TELEGEN_EBPF_MONGO_CACHE_SIZE=1024
TELEGEN_EBPF_KAFKA_CACHE_SIZE=1024

# =============================================================================
# Network Observability Configuration
# =============================================================================
# Enable network tracing
TELEGEN_NETWORK_ENABLED=true

# DNS tracking
TELEGEN_NETWORK_DNS_ENABLED=true
TELEGEN_NETWORK_DNS_CACHE_SIZE=10000

# TCP tracking
TELEGEN_NETWORK_TCP_ENABLED=true
TELEGEN_NETWORK_TCP_STATE_TRACKING=true
TELEGEN_NETWORK_TCP_RETRANSMISSIONS=true
TELEGEN_NETWORK_TCP_RTT=true

# Aggregation
TELEGEN_NETWORK_AGGREGATION_INTERVAL=30s
TELEGEN_NETWORK_MAX_FLOWS=100000

# =============================================================================
# Profiling Configuration
# =============================================================================
# Enable continuous profiling
TELEGEN_PROFILING_ENABLED=true

# CPU profiling
TELEGEN_PROFILING_CPU_ENABLED=true
TELEGEN_PROFILING_SAMPLE_RATE=99
TELEGEN_PROFILING_MAX_STACK_DEPTH=127

# Off-CPU profiling
TELEGEN_PROFILING_OFFCPU_ENABLED=true
TELEGEN_PROFILING_OFFCPU_MIN_BLOCK_TIME_NS=1000000

# Memory profiling
TELEGEN_PROFILING_MEMORY_ENABLED=true
TELEGEN_PROFILING_MEMORY_MIN_ALLOC_SIZE=1024

# Mutex profiling
TELEGEN_PROFILING_MUTEX_ENABLED=true
TELEGEN_PROFILING_MUTEX_THRESHOLD_NS=1000000

# Collection and upload intervals
TELEGEN_PROFILING_COLLECTION_INTERVAL=10s
TELEGEN_PROFILING_UPLOAD_INTERVAL=60s

# Output format
TELEGEN_PROFILING_OUTPUT_FORMAT=pprof

# =============================================================================
# Security Observability Configuration
# =============================================================================
# Enable security observability
TELEGEN_SECURITY_ENABLED=true

# Syscall auditing
TELEGEN_SECURITY_SYSCALL_AUDIT_ENABLED=true
TELEGEN_SECURITY_CAPTURE_EXECVE_ARGS=true

# File integrity monitoring
TELEGEN_SECURITY_FILE_INTEGRITY_ENABLED=true

# Container escape detection
TELEGEN_SECURITY_CONTAINER_ESCAPE_ENABLED=false

# Alerting
TELEGEN_SECURITY_ALERT_MIN_SEVERITY=high
TELEGEN_SECURITY_ALERT_RATE_LIMIT=100

# =============================================================================
# Database Tracing Configuration
# =============================================================================
# Enable database tracing
TELEGEN_DATABASE_TRACING_ENABLED=true

# PostgreSQL
TELEGEN_DATABASE_POSTGRESQL_ENABLED=true
TELEGEN_DATABASE_POSTGRESQL_SLOW_THRESHOLD=1s

# MySQL
TELEGEN_DATABASE_MYSQL_ENABLED=true
TELEGEN_DATABASE_MYSQL_SLOW_THRESHOLD=1s

# Redis
TELEGEN_DATABASE_REDIS_ENABLED=true
TELEGEN_DATABASE_REDIS_SLOW_THRESHOLD=100ms

# Kafka
TELEGEN_DATABASE_KAFKA_ENABLED=true

# =============================================================================
# Pipeline Configuration
# =============================================================================
# Traces pipeline
TELEGEN_PIPELINE_TRACES_ENABLED=true

# Metrics pipeline
TELEGEN_PIPELINE_METRICS_ENABLED=true
TELEGEN_PIPELINE_METRICS_EXPOSE_PROMETHEUS=true

# Logs pipeline
TELEGEN_PIPELINE_LOGS_ENABLED=true

# =============================================================================
# Queue Configuration
# =============================================================================
# Traces queue
TELEGEN_QUEUE_TRACES_MEM_LIMIT=256Mi
TELEGEN_QUEUE_TRACES_MAX_AGE=6h

# Logs queue
TELEGEN_QUEUE_LOGS_MEM_LIMIT=256Mi
TELEGEN_QUEUE_LOGS_MAX_AGE=24h

# Metrics queue
TELEGEN_QUEUE_METRICS_MEM_LIMIT=128Mi
TELEGEN_QUEUE_METRICS_MAX_AGE=5m

# =============================================================================
# Cloud Provider Configuration
# =============================================================================
# Auto-detect cloud provider
TELEGEN_CLOUD_AUTODETECT=true
TELEGEN_CLOUD_DETECTION_TIMEOUT=10s
TELEGEN_CLOUD_DETECTION_INTERVAL=5m

# AWS-specific settings
TELEGEN_AWS_ENABLED=true
TELEGEN_AWS_TIMEOUT=200ms
TELEGEN_AWS_REFRESH_INTERVAL=15m
TELEGEN_AWS_COLLECT_TAGS=false
TELEGEN_AWS_IMDSV2_ONLY=true

# GCP-specific settings
TELEGEN_GCP_ENABLED=true

# Azure-specific settings
TELEGEN_AZURE_ENABLED=true

# =============================================================================
# Discovery Configuration
# =============================================================================
# Exclude OTEL instrumented services
TELEGEN_DISCOVERY_EXCLUDE_OTEL=true

# Minimum process age
TELEGEN_DISCOVERY_MIN_PROCESS_AGE=5s

# =============================================================================
# Language Runtime Configuration
# =============================================================================
# Node.js instrumentation
TELEGEN_NODEJS_ENABLED=true

# Java agent
TELEGEN_JAVAAGENT_ENABLED=true
TELEGEN_JAVAAGENT_TIMEOUT=10s

# =============================================================================
# Backoff Configuration
# =============================================================================
TELEGEN_BACKOFF_INITIAL=500ms
TELEGEN_BACKOFF_MAX=30s
TELEGEN_BACKOFF_MULTIPLIER=2.0
TELEGEN_BACKOFF_JITTER=0.2

# =============================================================================
# Go Runtime Configuration
# =============================================================================
# Maximum OS threads
GOMAXPROCS=4

# GC target percentage
GOGC=100

# Memory limit (optional)
# GOMEMLIMIT=900MiB

# =============================================================================
# Debug Configuration
# =============================================================================
# Trace printer: disabled, text, json
TELEGEN_TRACE_PRINTER=disabled

# Profile port (0 = disabled)
TELEGEN_PROFILE_PORT=0
