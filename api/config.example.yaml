agent:
  service_name: telegen

selfTelemetry:
  listen: ":19090"
  prometheus_namespace: "telegen"

cloud:
  aws:
    enabled: true
    timeout: "200ms"
    refresh_interval: "15m"
    collect_tags: false
    tag_allowlist: []

queues:
  traces:  { mem_limit: "256Mi", max_age: "6h" }
  logs:    { mem_limit: "256Mi", max_age: "24h" }
  metrics: { mem_limit: "128Mi", max_age: "5m" }

backoff:
  initial: "500ms"
  max: "30s"
  multiplier: 2.0
  jitter: 0.2

# =============================================================================
# Export Configuration - OTel Collector Compatible
# =============================================================================
# All signals include telegen.* metadata attributes for indexing:
#   - telegen.signal.category
#   - telegen.signal.subcategory
#   - telegen.source.module
#   - telegen.bpf.component
#   - telegen.signal.description
#   - telegen.collector.type
# =============================================================================

exports:
  # Include signal metadata in all exports for indexing
  include_signal_metadata: true
  
  # Control which metadata fields are exported (to reduce storage costs)
  # Each field can be independently enabled/disabled
  # Can also be set via environment variables:
  #   TELEGEN_METADATA_CATEGORY, TELEGEN_METADATA_SUBCATEGORY, etc.
  metadata_fields:
    # Top-level category (e.g., "Host Metrics", "Database Traces")
    enable_category: true
    # Sub-category (e.g., "CPU Utilization", "PostgreSQL")
    enable_subcategory: true
    # Go source module path
    enable_source_module: true
    # eBPF component file path
    enable_bpf_component: true
    # Human-readable description (verbose, disabled by default)
    enable_description: false
    # Collector type (ebpf, jfr, snmp, api, procfs, nvml)
    enable_collector_type: true
  
  # Prometheus Remote Write - compatible with OTel Collector prometheusremotewritereceiver
  remoteWrite:
    mode: "active"
    # OTel Collector prometheusremotewritereceiver endpoint
    endpoints:
      - url: "http://otel-collector:19291/api/v1/push"
        timeout: "30s"
        headers: {}
        tenant: ""
        # snappy is standard for Prometheus Remote Write
        compression: "snappy"
    tls:
      enable: false
      ca_file: ""
      cert_file: ""
      key_file: ""
      insecure_skip_verify: false
    batch:
      size: 1000
      flush_interval: "15s"
    retry:
      max_retries: 3
      backoff: "1s"

  # OTLP export - compatible with OTel Collector otlpreceiver
  otlp:
    send_mode: "failover"
    tls:
      enable: false
      ca_file: ""
      cert_file: ""
      key_file: ""
      insecure_skip_verify: false
    # gRPC endpoint for traces, metrics, and logs
    grpc:
      enabled: true
      endpoint: "otel-collector:4317"
      headers: {}
      insecure: true
      compression: "gzip"
      timeout: "30s"
    # HTTP endpoint (alternative to gRPC)
    http:
      enabled: false
      endpoint: "otel-collector:4318"
      insecure: true
      traces_path: "/v1/traces"
      logs_path: "/v1/logs"
      metrics_path: "/v1/metrics"
      headers: {}
      compression: "gzip"
      timeout: "30s"

pipelines:
  metrics:
    also_expose_prometheus: true
  traces:
    enabled: true
  logs:
    enabled: true
    filelog:
      include: ["/var/log/*.log", "/var/log/*/*.log"]
      position_file: "/var/lib/telegen/positions.json"
  jfr:
    enabled: false
    input_dirs:
      - "/var/log/jfr"
    recursive: true
    output_dir: "/var/log/jfr-json"
    poll_interval: "5s"
    sample_interval_ms: 10
    jfr_command: "jfr"
    workers: 2
    pretty_json: false
