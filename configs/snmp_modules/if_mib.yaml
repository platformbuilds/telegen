# IF-MIB Module - RFC 2863
# Standard interface metrics for network devices

module: if_mib
description: "RFC 2863 - The Interfaces Group MIB"

walk:
  - "1.3.6.1.2.1.2.2"      # ifTable
  - "1.3.6.1.2.1.31.1.1"   # ifXTable (64-bit counters)

metrics:
  # Interface Status
  - name: interface_admin_status
    oid: "1.3.6.1.2.1.2.2.1.7"
    type: gauge
    help: "The desired state of the interface (1=up, 2=down, 3=testing)"
    indexes:
      - labelname: ifIndex
        type: Integer
    lookups:
      - labels: [ifIndex]
        oid: "1.3.6.1.2.1.31.1.1.1.1"
        labelname: ifName
    enum_values:
      1: up
      2: down
      3: testing

  - name: interface_oper_status
    oid: "1.3.6.1.2.1.2.2.1.8"
    type: gauge
    help: "The current operational state of the interface"
    indexes:
      - labelname: ifIndex
        type: Integer
    lookups:
      - labels: [ifIndex]
        oid: "1.3.6.1.2.1.31.1.1.1.1"
        labelname: ifName
    enum_values:
      1: up
      2: down
      3: testing
      4: unknown
      5: dormant
      6: notPresent
      7: lowerLayerDown

  # Interface Properties
  - name: interface_mtu_bytes
    oid: "1.3.6.1.2.1.2.2.1.4"
    type: gauge
    help: "The size of the largest packet which can be sent/received"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_speed_bps
    oid: "1.3.6.1.2.1.2.2.1.5"
    type: gauge
    help: "An estimate of the interface's current bandwidth in bits per second"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_high_speed_mbps
    oid: "1.3.6.1.2.1.31.1.1.1.15"
    type: gauge
    help: "An estimate of the interface's current bandwidth in Mbps"
    indexes:
      - labelname: ifIndex
        type: Integer

  # Traffic Counters (64-bit)
  - name: interface_in_octets_total
    oid: "1.3.6.1.2.1.31.1.1.1.6"
    type: counter
    help: "The total number of octets received on the interface (64-bit)"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_out_octets_total
    oid: "1.3.6.1.2.1.31.1.1.1.10"
    type: counter
    help: "The total number of octets transmitted out of the interface (64-bit)"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_in_ucast_pkts_total
    oid: "1.3.6.1.2.1.31.1.1.1.7"
    type: counter
    help: "The number of unicast packets delivered to a higher-layer protocol (64-bit)"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_out_ucast_pkts_total
    oid: "1.3.6.1.2.1.31.1.1.1.11"
    type: counter
    help: "The total number of unicast packets transmitted (64-bit)"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_in_multicast_pkts_total
    oid: "1.3.6.1.2.1.31.1.1.1.8"
    type: counter
    help: "The number of multicast packets delivered (64-bit)"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_out_multicast_pkts_total
    oid: "1.3.6.1.2.1.31.1.1.1.12"
    type: counter
    help: "The total number of multicast packets transmitted (64-bit)"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_in_broadcast_pkts_total
    oid: "1.3.6.1.2.1.31.1.1.1.9"
    type: counter
    help: "The number of broadcast packets delivered (64-bit)"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_out_broadcast_pkts_total
    oid: "1.3.6.1.2.1.31.1.1.1.13"
    type: counter
    help: "The total number of broadcast packets transmitted (64-bit)"
    indexes:
      - labelname: ifIndex
        type: Integer

  # Error Counters
  - name: interface_in_errors_total
    oid: "1.3.6.1.2.1.2.2.1.14"
    type: counter
    help: "The number of inbound packets that contained errors"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_out_errors_total
    oid: "1.3.6.1.2.1.2.2.1.20"
    type: counter
    help: "The number of outbound packets that could not be transmitted"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_in_discards_total
    oid: "1.3.6.1.2.1.2.2.1.13"
    type: counter
    help: "The number of inbound packets which were discarded"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_out_discards_total
    oid: "1.3.6.1.2.1.2.2.1.19"
    type: counter
    help: "The number of outbound packets which were discarded"
    indexes:
      - labelname: ifIndex
        type: Integer

  - name: interface_in_unknown_protos_total
    oid: "1.3.6.1.2.1.2.2.1.15"
    type: counter
    help: "The number of packets received via unknown protocol"
    indexes:
      - labelname: ifIndex
        type: Integer

  # Interface Metadata (for lookups)
  - name: interface_info
    oid: "1.3.6.1.2.1.31.1.1.1.1"
    type: info
    help: "Interface name from ifXTable"
    indexes:
      - labelname: ifIndex
        type: Integer
